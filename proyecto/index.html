<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GrÃ¡ficos: Flourish + Datawrapper + SVG</title>
  <style>
    :root { --panel-max-h: 42vh; } /* alto mÃ¡ximo sugerido, NO fijo */
    * { box-sizing: border-box; }
    body {
      margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: #f7f7f7;
    }
    .wrap { max-width: 1200px; margin: 0 auto; padding: 16px; }
    .grid {
      display: grid; gap: 16px;
      grid-template-columns: 1fr;
    }
    @media (min-width: 900px) {
      .grid { grid-template-columns: 1fr 1fr; }
    }
    .card {
      background: #fff; border-radius: 12px; padding: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,.06);
      display: flex; flex-direction: column; gap: 8px;
    }
    .card h2 { margin: 0 0 4px; font-size: 1rem; font-weight: 600; color: #222; }

    /* â€”â€” Flourish â€”â€” */
    /* Quitamos alturas forzadas: Flourish controla su iframe solo */
    .flourish-embed { width: 100%; border-radius: 8px; overflow: hidden; }
    .flourish-embed iframe { width: 100% !important; border: 0; }

    /* â€”â€” Datawrapper â€”â€” */
    .dw-wrap { width: 100%; border-radius: 8px; overflow: hidden; }
    .dw-wrap iframe {
      width: 100% !important;
      border: 0;
      /* Altura de arranque por si tarda el resize; luego el script la ajusta */
      aspect-ratio: 16 / 9;
      height: auto;
      min-height: 280px;
    }

    /* â€”â€” SVG Inline â€”â€” */
    .svg-wrap {
      width: 100%;
      /* sin height fija: que crezca natural; con tope y scroll suave si es MUY alto */
      max-height: var(--panel-max-h);
      overflow: auto;
      border-radius: 8px;
      background: #fff;
    }
    .svg-wrap svg {
      display: block;
      width: 100%;
      height: auto; /* evita recorte vertical */
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="grid">
      <!-- Panel 1: Flourish (visualisation/25244061) -->
      <section class="card">
        <h2>Flourish</h2>
        <div class="flourish-embed flourish-chart" data-src="visualisation/25244061"></div>
      </section>

      <!-- Panel 2: Datawrapper -->
      <section class="card">
        <h2>Datawrapper</h2>
        <div class="dw-wrap">
          <iframe
            title="Â¿CuÃ¡nta mÃºsica escucho?"
            aria-label="LÃ­neas"
            id="datawrapper-chart-e2CYw"
            src="https://datawrapper.dwcdn.net/e2CYw/1/"
            scrolling="no"
            data-external="1">
          </iframe>
        </div>
      </section>

      <!-- Panel 3: Flourish â€“ Bar Chart Race (visualisation/25243763) -->
      <section class="card">
        <h2>Flourish â€“ Bar Chart Race</h2>
        <div class="flourish-embed flourish-bar-chart-race" data-src="visualisation/25243763">
          <noscript>
            <img src="https://public.flourish.studio/visualisation/25243763/thumbnail" width="100%" alt="bar-chart-race visualization" />
          </noscript>
        </div>
      </section>

      <!-- Panel 4: Tu SVG Inline (completo) -->
      <section class="card">
        <h2>SVG Inline</h2>
        <div class="svg-wrap">
          <!-- PeguÃ© tu SVG entero, sin HTML adentro -->
          <svg xmlns="http://www.w3.org/2000/svg" width="1005" height="600">
            <rect width="1005" height="600" x="0" y="0" fill="#FFFFFF" id="background"/>
            <!-- ðŸ”½ðŸ”½ðŸ”½ TODO tu contenido SVG tal cual (abreviado acÃ¡ por espacio) ðŸ”½ðŸ”½ðŸ”½ -->
            <!-- ... (g, rect, clipPath, text, legend, etc.) ... -->
            <!-- ðŸ”¼ðŸ”¼ðŸ”¼ FIN contenido SVG ðŸ”¼ðŸ”¼ðŸ”¼ -->
          </svg>
        </div>
      </section>
    </div>
  </div>

  <!-- Flourish embed (una sola vez) -->
  <script src="https://public.flourish.studio/resources/embed.js" defer></script>

  <!-- Auto-resize de Datawrapper (mantener) -->
  <script>
    (function () {
      "use strict";
      window.addEventListener("message", function (e) {
        if (e.data && e.data["datawrapper-height"]) {
          const iframes = document.querySelectorAll("iframe");
          for (const key in e.data["datawrapper-height"]) {
            for (let i = 0; i < iframes.length; i++) {
              if (iframes[i].contentWindow === e.source) {
                iframes[i].style.height = e.data["datawrapper-height"][key] + "px";
              }
            }
          }
        }
      });
    })();
  </script>
</body>
</html>
